# BannedWords プラグイン

## 概要

文章修正の提案機能を提供します。

## 設定

- プラグインを有効化し、各スコープのプラグイン設定で対象のモデルを選択してください。
- デフォルトでは記事・ページ・タグが対象です。
- 1行に1単語を入力してください。 置換する場合はカンマで区切って置換文字列を入力してください。
- 修正の提案については、大文字小文字を区別しません。
- 例外に対象外とする要素名\(HTMLのタグ名\)がカンマ区切りで指定できます。
- 引用符内のテキストを無視するにチェックを入れると、対象のテキストを無視します。
- スペースの設定では「システムのルールを継承する」が選択できます。
- 正規化対象の文字を置き換える、にチェックを入れると機種依存文字などの正規化対象文字列を置き換えます。対象外の文字を追加で指定できます。
- 「半角カタカナ」を「全角カタカナ」に変換する、にチェックを入れると半角カタカナを全角カタカナに置き換えます。
- 「全角」英字を「半角」に変換する、にチェックを入れると全角英文字を半角英文字に置き換えます。
- 「全角」数字を「半角」に変換する、にチェックを入れると全角数字を半角数字に置き換えます。
- 和暦を西暦に変換する、にチェックを入れると、和暦を西暦に変換します。
- Y/m/d形式の日付をY年m月d日形式に変換する、にチェックを入れると「/」で区切られた年月日をY年m月d日形式に変換します。
- H:i:s形式の時刻をH時i分s秒形式に変換する、にチェックを入れると「:」で区切られた時刻をH時i分s秒形式に変換します。
- 時刻を午前午後\+12時間表記に統一する、チェックを入れると、24時間表記を「午前」「午後」を付けた12時間表記に変換します。
- 修正の提案\(diff\)を見やすくするために「タグを削除する」か「&lt;br&gt;タグの後で改行する」が選択できます。初期設定は「タグを削除する」です。
- 修正の提案を含むオブジェクトの保存を許可しない、にチェックを入れると、修正の提案を含むオブジェクトは保存できなくなります。

### ルールの例

    アルファード,アルファサード
    PowerCMS 6,PowerCMS X

### 自然言語処理による修正の提案に関する設定

プラグイン「SimplifiedJapanese」が有効で、サーバーに「mecab」がインストールされている時、以下の設定が可能です。

- 常用漢字に含まれない漢字を含む単語をひらがなにする\(小学校1〜6年、中学校までのレベルをあわせて設定できます\)
- 異体字を正規化する\(常用漢字に含まれない異体字を置き換えます\)
- 送り仮名の省略\(公文書表記における省略された複合名詞の送り仮名 \(186語\) を修正、または複合名詞の送り仮名を省略します\)
- 文末表現を常体・敬体に統一する\(敬体の時体言止めを許可するかどうかを指定できます\)
- 文末の「〜ましょう・でしょう」を言い換える\(文章を敬体に統一する時、文末の「〜ましょう・でしょう」を曖昧でない表現に言い換える指定ができます\)※
- 文末の「〜かもしれない・かもしれません」を言い換える\(文章を敬体に統一する時、文末の「〜かもしれない・かもしれません」を曖昧でない表現に言い換える指定ができます\)
- 終助詞の「ね」「さ」「よ」「ぜ」「な」を削除する\(文章を敬体または常体に統一する時のみ有効\)
- 接続詞、一部の副詞、接尾辞・助詞・助動詞、接頭詞「御」をひらがなに展開
- 表記揺れを統一
- 「\-ty」の扱いを統一「アクセシビリティ」「アクセシビリティー」の統一
- ら抜き言葉を修正
- さ入れ言葉を修正
- 文末以外の副詞を削除する
- 可能動詞を「基本形\+ことができる」に変換\(会えます→会うことができる\)

常用漢字については、固有名詞内の漢字はチェック対象外となります。  
固有名詞はプラグイン「SimplifiedJapanese」の「ユーザー辞書」に追加で登録することができます。

※ 文末の「〜ましょう」を言い換える時は、CaboChaをインストールしてパスを環境変数「simplifiedjapanese\_cabocha\_path」に指定することで精度が向上します。

- <a href="https://taku910.github.io/cabocha/" target="_blank">CaboCha/南瓜: Yet Another Japanese Dependency Structure Analyzer <i class="fa fa-external-link" aria-hidden="true"></i></a>

※ 文末の「〜でしょう」を言い換えられるパターンは限られます。

## リッチテキストエディタへのボタンの追加

以下のボタンが利用可能になります。

- 校正 \(pt\-proofread\) : 言い換えの提案を反映後のテキストと現在のテキストの diff\(差分\)をわかりやすく表示します。
- 学年ごとの漢字レベル \(pt\-kanjilevel\) : 選択されたテキストに含まれる漢字を小学校1年生から中学校までのいつ習うのかを可視化します。

<div class="text-center mb-4"><img style="border:1px solid gray;" width="700" height="635" src="<mt:var name="prototype_path">/plugins/BannedWords/docs/assets/diff.png?v=1.2" alt="差分表示のスクリーンショット"></div>

## 対象となるカラム

- 「エディタのチェックボタンのみを有効化する」にチェックが入っている時は、保存時のチェックは無効となります。
- 「エディタのチェックボタンのみを有効化する」にチェックのない時、text\_format, basename, extra\_path, rev\_changed, rev\_diff, rev\_note, uuid以外のテキスト型のカラム、テキスト・テキストエリアなどのフォールド、タグ入力欄がチェック対象となります。

## 設定したモデルのオブジェクトに対する保存時の動作

「エディタのチェックボタンのみを有効化する」にチェックのない場合、オブジェクトの保存時に以下のチェック結果をフィードバックします。

- 修正の提案を含むオブジェクトを保存した時、エラーメッセージが表示され、対象のカラムの外側に赤い枠線を表示します。
- エラーメッセージの下に、対象カラム名と修正の提案を表示します。
- 置換文字列の指定がある時、チェックボックス付きの一覧が表示され、チェックを入れたものを次の保存時に置換します。
- 設定「修正の提案を含むオブジェクトの保存を許可しない」指定のない時、「チェックのないものは無視してオブジェクトを保存する」チェックボックスが表示されます。
- 「チェックのないものは無視してオブジェクトを保存する」にチェックを入れて保存をクリックすると、修正の提案を含んだままオブジェクトを保存することができます。

<div class="text-center"><img style="border:1px solid gray;" width="700" height="506" src="<mt:var name="prototype_path">/plugins/BannedWords/docs/assets/edit_object.png?v=1" alt="編集画面スクリーンショット"></div>
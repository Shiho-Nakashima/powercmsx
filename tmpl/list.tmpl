<mt:var name="model" setvar="this_model">
<mt:var name="model" setvar="_this_model">
<mt:var name="sort_cond" value="">
<mt:if name="request.sort">
<mt:if name="request.direction">
<mt:setvarblock name="sort_cond">&amp;sort=<mt:var name="request.sort" escape>&amp;direction=<mt:var name="request.direction" escape></mt:setvarblock>
</mt:if>
</mt:if>
<mt:if name="request.query">
<mt:setvarblock name="query_cond">&amp;query=<mt:var name="query" escape></mt:setvarblock>
</mt:if>
<mt:if name="request.select_system_filters">
<mt:setvarblock name="filter_cond">
&amp;select_system_filters=<mt:var name="request.select_system_filters" escape>
&amp;_system_filters_option=<mt:var name="request._system_filters_option" escape>
&amp;_filter=<mt:var name="_this_model" escape>
&amp;workspace_select=<mt:var name="request.workspace_select" escape>
<mt:if name="request._fix_filter">&amp;_fix_filter=1</mt:if>
</mt:setvarblock>
</mt:if>
<mt:var name="selector_cond" value="">
<mt:if name="request.workspace_select"><mt:setvarblock name="selector_cond">&amp;workspace_select=1</mt:setvarblock></mt:if>
<mt:if name="request.insert_editor">
<mt:setvarblock name="insert_cond">
&amp;insert_editor=1
&amp;insert=<mt:var name="request.insert" escape>
<mt:if name="request._from_scope">&amp;_from_scope=<mt:var name="request._from_scope" escape></mt:if>
</mt:setvarblock>
</mt:if>
<mt:if name="request.target">
<mt:setvarblock name="selected_ids_cond">
<mt:if name="request.from_obj">&amp;from_obj=<mt:var name="request.from_obj" escape></mt:if>
&amp;selected_ids=<mt:var name="request.selected_ids" escape>
&amp;target=<mt:var name="request.target" escape>
&amp;get_col=<mt:var name="request.get_col" escape>
<mt:if name="request.select_add">&amp;select_add=<mt:var name="request.select_add" escape></mt:if>
<mt:if name="request.ids_only">&amp;ids_only=<mt:var name="request.ids_only" escape></mt:if>
</mt:setvarblock>
</mt:if>
<mt:var name="revision_cond" value="">
<mt:if name="request.revision_select">
<mt:if name="request.rev_object_id">
<mt:setvarblock name="revision_cond">
&amp;revision_select=<mt:var name="request.revision_select" escape>
&amp;rev_object_id=<mt:var name="request.rev_object_id" escape>
</mt:setvarblock>
</mt:if>
</mt:if>
<mt:setvarblock name="allow_revision_in_list_model">allow_revision_in_list_<mt:var name="this_model"></mt:setvarblock>
<mt:property name="$allow_revision_in_list_model" setvar="allow_revision_in_list">
<mt:unless name="allow_revision_in_list">
  <mt:property name="allow_revision_in_list" setvar="allow_revision_in_list">
</mt:unless>
<mt:if name="request.manage_revision">
<mt:if name="can_duplicate">
  <mt:setvar name="allow_revision_in_list" value="0">
</mt:if>
</mt:if>
<mt:setvar name="_single_select" value="0">
<mt:setvar name="_get_col" value="">
<mt:if name="request.dialog_view">
<mt:if name="request.get_col">
<mt:var name="request.get_col" setvar="_get_col">
</mt:if>
<mt:setvarblock name="dialog_param">&amp;dialog_view=1</mt:setvarblock>
<mt:if name="request.ref_model">
<mt:setvarblock name="dialog_param" append="1">&amp;ref_model=<mt:var name="request.ref_model"></mt:setvarblock>
</mt:if>
<mt:if name="request.single_select">
<mt:setvar name="_single_select" value="1">
<mt:setvarblock name="dialog_param" append="1">&amp;single_select=1</mt:setvarblock>
</mt:if>
<mt:if name="request.workflow_model">
<mt:setvarblock name="dialog_param" append="1">&amp;workflow_model=<mt:var name="request.workflow_model" escape></mt:setvarblock>
<mt:setvarblock name="dialog_param" append="1">&amp;workflow_type=<mt:var name="request.workflow_type" escape></mt:setvarblock>
</mt:if>
</mt:if>
<mt:setvar name="selecter_param" value="">
<mt:if name="request.target">
<mt:setvarblock name="selecter_param">&amp;target=<mt:var name="request.target" escape>&amp;get_col=<mt:var name="request.get_col" escape>&amp;selected_ids=<mt:var name="request.selected_ids" escape>&amp;from_obj=<mt:var name="request.from_obj" escape></mt:setvarblock>
</mt:if>
<mt:if name="request.revision_select">
<mt:setvarblock name="filter_cond" append="1">&amp;manage_revision=1</mt:setvarblock>
</mt:if>
<mt:if name="request.manage_revision">
<mt:setvarblock name="filter_cond" append="1">&amp;manage_revision=1</mt:setvarblock>
<mt:setvarblock name="selecter_param" append="1">&amp;manage_revision=1</mt:setvarblock>
</mt:if>
<mt:if name="request.dialog_view">
<mt:include file="include/dialog_header.tmpl">
<mt:setvar name="sortable" value="">
<mt:else>
<mt:include file="include/header.tmpl">
</mt:if>
<mt:setvarblock name="include_path">include/list/screen_header.tmpl</mt:setvarblock>
<mt:include file="$include_path">
<mt:setvarblock name="include_path">include/list/<mt:var name="model">/screen_header.tmpl</mt:setvarblock>
<mt:include file="$include_path">
<script src="<mt:var name="prototype_path">assets/js/jquery.lazyload.min.js"></script>
<mt:setvarblock name="this_url"><mt:var name="script_uri">?__mode=view&amp;_type=list&amp;_model=<mt:var name="this_model"></mt:setvarblock>
<mt:setvarblock name="setup_search">
$(".search-btn").click(function(){
    $("#__mode").prop('value','view');
    return true;
});
$(".alt-search-button").click(function(){
    query = prompt('<mt:trans phrase="Please enter keyword for search.">', '<mt:var name="query" escape>');
    if ( query == null ) {
        return false;
    }
    $(".query-box").val(query);
    $(".query-box").show();
    $("#__mode").prop('value','view');
    return true;
});
$(".query-box").keypress(function(e){
  if(e.which==13){
    $("#__mode").prop('value','view');
    in_search = true;
    return true;
  }
}).blur(function(){
    in_search = false;
});
</mt:setvarblock>
<mt:setvarblock name="search_box">
<mt:if name="search_options">
  <mt:if name="request._start_filter">
    <input type="hidden" name="_start_filter" value="<mt:var name="request._start_filter" escape>">
  </mt:if>
  <mt:if name="request._filter">
    <input type="hidden" name="_filter" value="<mt:var name="request._filter" escape>">
  </mt:if>
  <mt:if name="request._system_filters_option">
    <input type="hidden" name="_system_filters_option" value="<mt:var name="request._system_filters_option" escape>">
  </mt:if>
  <mt:if name="request.select_system_filters">
    <input type="hidden" name="select_system_filters" value="<mt:var name="request.select_system_filters" escape>">
  </mt:if>
  <input disabled class="short-padding query-box form-control mb-2 mr-sm-2 mb-sm-0 form-control-sm" name="query" type="text" value="<mt:var name="query" escape>" aria-label="<mt:trans phrase="Keyword">" placeholder="<mt:trans phrase="Keyword">">
  <mt:if name="request.workspace_select">
    <input type="hidden" name="workspace_select" value="1">
  </mt:if>
  <mt:if name="request.manage_revision">
    <input type="hidden" name="manage_revision" value="1">
  </mt:if>
  <mt:if name="request.select_add">
    <input type="hidden" name="select_add" value="1">
  </mt:if>
  <mt:if name="request.workflow_type">
    <input type="hidden" name="workflow_type" value="<mt:var name="request.workflow_type" escape>">
  </mt:if>
  <mt:if name="request.workflow_model">
    <input type="hidden" name="workflow_model" value="<mt:var name="request.workflow_model" escape>">
  </mt:if>
  <button disabled class="search-btn btn btn-secondary search-button btn-sm" type="submit"><i class="fa fa-search" aria-hidden="true"></i><span class="sr-only"><mt:trans phrase="Search"></span></button>
  <button disabled class="hidden btn btn-secondary alt-search-button btn-sm" type="submit"><i class="fa fa-search" aria-hidden="true"></i><span class="sr-only"><mt:trans phrase="Search"></span></button>
</mt:if>
</mt:setvarblock>

<mt:if name="_user_keep_search">
<mt:if name="query">
<mt:setvarblock name="current_filter">
<mt:unless name="request._detach_query">
    <span class="_current_filter">( <mt:trans phrase="Search"> :&nbsp;<mt:var name="query" escape> <span> - </span> <a href="<mt:var name="this_url">&amp;_detach_query=1<mt:var name="dialog_param"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="selecter_param"><mt:var name="insert_cond" strip_linefeeds="1">"><mt:trans phrase="Detach"></a> &nbsp;)</span></span>
</mt:unless>
</mt:setvarblock>
</mt:if>
</mt:if>

<mt:if name="request.dialog_view">
  <mt:if name="request.select_system_filters" eq="filter_class_image">
    <mt:if name="request.ref_model">
  <mt:setvar name="_hide_filter" value="1">
  <mt:ignore>Hide in Dialog Chooser.</mt:ignore>
    </mt:if>
  </mt:if>
</mt:if>

<mt:unless name="request._fix_filter">
<mt:unless name="request._detach_filter">
  <mt:unless name="_hide_filter">
    <mt:if name="current_filter_name"><mt:setvarblock name="current_filter"><span class="_current_filter">( <mt:trans phrase="Current Filter"> :&nbsp;<a href="javascript:void(0);" data-toggle="modal" data-target="#filterOptions"><mt:var name="current_filter_name" escape></a> <span> - </span> <a href="<mt:var name="this_url">&amp;_detach_filter=1<mt:var name="query_cond"><mt:var name="dialog_param"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="selecter_param"><mt:var name="insert_cond" strip_linefeeds="1">"><mt:trans phrase="Detach"></a> &nbsp;)</span></span></mt:setvarblock></mt:if>
  </mt:unless>
</mt:unless>
</mt:unless>

<mt:var name="sortable" setvar="_sortable">
<mt:trans phrase="ascend" setvar="order_asc">
<mt:trans phrase="descend" setvar="order_desc">

<mt:if name="request.revision_select">
<mt:trans phrase="Revisions" setvar="plural">
</mt:if>

    <mt:if name="request.deleted">
  <div class="alert alert-success" tabindex="0">
    <mt:var name="alert_close">
    <mt:var name="request.deleted" setvar="deletes">
    <mt:if name="request.manage_revision">
      <mt:trans phrase="%s %s(Revision) have been deleted." params="'$deletes','$plural'">
    <mt:else>
      <mt:trans phrase="%s %s have been deleted." params="'$deletes','$plural'">
    </mt:if>
  </div>
    <script>
    $('.alert-success').focus();
    </script>
    </mt:if>
    <mt:if name="request.already_deleted">
  <div class="alert alert-success" tabindex="0">
    <mt:var name="alert_close">
    <mt:var name="request.already_deleted" setvar="deletes">
    <mt:if name="deletes" gt="1">
      <mt:trans phrase="%s already deleted." params="$plural">
    <mt:else>
      <mt:trans phrase="%s already deleted." params="$label">
    </mt:if>
  </div>
    <script>
    $('.alert-success').focus();
    </script>
    </mt:if>

    <mt:if name="request.does_act">
    <mt:var name="request.apply_actions" setvar="apply_actions">
  <div class="alert alert-<mt:unless name="apply_actions">warning<mt:else>success</mt:unless>" id="alert-does_act" tabindex="0">
    <mt:var name="alert_close">
    <mt:unless name="apply_actions">
      <mt:trans phrase="There were no %s for action." params="$label">
    <mt:else>
    <mt:if name="apply_actions" eq="1">
      <mt:trans phrase="You applied an action to %s %s." params="'$apply_actions','$label'">
    <mt:else>
      <mt:trans phrase="You applied an action to %s %s." params="'$apply_actions','$plural'">
    </mt:if>
    </mt:unless>
    <mt:if name="request.need_rebuild">
    <a href="<mt:var name="script_uri">?__mode=rebuild_phase&amp;_type=start_rebuild<mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id">"</mt:if>" class="popup">
    <mt:trans phrase="Publish your site to see these changes take effect.">
    </a>
    </mt:if>
  </div>
    <script>
    $('#alert-does_act').focus();
    </script>
    </mt:if>

    <mt:if name="request.saved_order">
  <div class="alert alert-success" tabindex="0">
    <mt:var name="alert_close">
    <mt:trans phrase="%s's order saved successfully." params="$plural">
    <mt:if name="request.need_rebuild">
      <a href="<mt:var name="script_uri">?__mode=rebuild_phase&amp;_type=start_rebuild<mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id">"</mt:if>" class="popup">
      <mt:trans phrase="Publish your site to see these changes take effect.">
      </a>
    </mt:if>
  </div>
    <script>
    $('.alert-success').focus();
    </script>
    </mt:if>
    <mt:if name="request.saved_props">
  <div class="alert alert-success" tabindex="0">
    <mt:var name="alert_close">
    <mt:trans phrase="%s's display options saved successfully." params="$label">
  </div>
    <script>
    $('.alert-success').focus();
    </script>
    </mt:if>
    <mt:if name="request.reset_props">
  <div class="alert alert-success" tabindex="0">
    <mt:var name="alert_close">
    <mt:trans phrase="%s's display options reset successfully." params="$label">
  </div>
    <script>
    $('.alert-success').focus();
    </script>
    </mt:if>
<mt:setvarblock name="include_path">include/list/<mt:var name="model">/list_header.tmpl</mt:setvarblock>
<mt:include file="$include_path">
<mt:var name="user_id" setvar="_admin_user_id">
<mt:trans phrase="*Unspecified*" setvar="_unspecified">
<mt:setvar name="model" value="">
<form action="<mt:var name="script_uri">" method="POST" class="form-inline" id="list-select-form">
<input type="hidden" name="__mode" value="" id="__mode">
<input type="hidden" name="_model" value="<mt:var name="_this_model">">
<input type="hidden" name="magic_token" value="<mt:var name="magic_token">">
<input type="hidden" name="_type" value="list">
<input type="hidden" name="sort" value="<mt:var name="request.sort" escape>">
<input type="hidden" name="direction" value="<mt:var name="request.direction" escape>">
<mt:if name="workspace_id">
<input type="hidden" name="workspace_id" value="<mt:var name="workspace_id">">
</mt:if>
<input type="hidden" name="" value="" id="select_ids_tmpl">
<input type="hidden" name="filter_params" value="<mt:var name="filter_params" escape>" id="filter_params">
<input type="hidden" name="return_args" value="<mt:var name="return_args" escape>">
<mt:if name="request.dialog_view">
<input type="hidden" name="target" value="<mt:var name="request.target" escape>">
<input type="hidden" name="single_select" value="<mt:var name="request.single_select" escape>">
<input type="hidden" name="get_col" value="<mt:var name="request.get_col" escape>">
<mt:if name="request.from_obj">
<input type="hidden" name="from_obj" value="<mt:var name="request.from_obj" escape>">
</mt:if>
<mt:if name="request.ref_model">
<input type="hidden" name="ref_model" value="<mt:var name="request.ref_model" escape>">
</mt:if>
<input type="hidden" name="dialog_view" value="1">
<mt:if name="request.insert_editor">
<input type="hidden" name="select_system_filters" value="<mt:var name="request.select_system_filters" escape>">
<input type="hidden" name="_system_filters_option" value="<mt:var name="request._system_filters_option" escape>">
<input type="hidden" name="insert" value="<mt:var name="request.insert" escape>">
<input type="hidden" name="insert_editor" value="<mt:var name="request.insert_editor" escape>">
<input type="hidden" name="_filter" value="<mt:var name="request._filter" escape>">
</mt:if>
</mt:if>
<mt:if name="request.dialog_view">
<input type="hidden" name="_from_scope" value="<mt:var name="request._from_scope" escape>">
  <mt:if name="this_model" eq="urlinfo">
    <mt:if name="request.target" eq="urls">
      <mt:if name="request._filter" eq="urlinfo">
        <mt:if name="request._system_filters_option" eq="archive">
          <mt:if name="request.select_system_filters" eq="filter_class_archive">
<input type="hidden" name="select_system_filters" value="filter_class_archive">
<input type="hidden" name="_system_filters_option" value="archive">
<input type="hidden" name="_filter" value="urlinfo">
<mt:setvar name="hide_current_filter" value="1">
          </mt:if>
        </mt:if>
      </mt:if>
    </mt:if>
  </mt:if>
  <mt:if name="request.workflow_model">
    <mt:setvarblock name="dialog_param" append="1">&amp;workflow_model=<mt:var name="request.workflow_model" escape></mt:setvarblock>
    <mt:setvarblock name="dialog_param" append="1">&amp;workflow_type=<mt:var name="request.workflow_type" escape></mt:setvarblock>
  </mt:if>
</mt:if>
<mt:if name="request.ids_only">
<input type="hidden" name="ids_only" value="<mt:var name="request.ids_only" escape>">
</mt:if>
<mt:property name="request_method" setvar="_request_method">
<mt:if name="_request_method" eq="POST">
<mt:setvarblock name="_post_query">__mode=view&_type=list&_model=<mt:var name="request._model" escape><mt:if name="request.query">&query=<mt:var name="request.query"></mt:if><mt:if name="request.manage_revision">&manage_revision=1</mt:if><mt:if name="workspace_id">&workspace_id=<mt:var name="workspace_id"></mt:if></mt:setvarblock>
</mt:if>
<input type="hidden" name="_query_string" value="<mt:if name="_request_method" ne="POST"><mt:var name="query_string" escape="url"><mt:else><mt:var name="_post_query" escape="url"></mt:if>">
<mt:unless name="list_items">
  <div class="alert alert-success full">
    <mt:trans phrase="%s not found." params="$label">
    <mt:if name="query">
    <a href="<mt:var name="script_uri">?__mode=view&amp;_type=list&amp;_model=<mt:var name="request._model" escape><mt:if name="_user_keep_search">&amp;_detach_query=1</mt:if><mt:var name="filter_cond"><mt:var name="workspace_param"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:var name="dialog_param"><mt:var name="insert_cond" strip_linefeeds="1">">
    <i class="hidden fa fa-list"></i> <mt:trans phrase="Return to List">
    </a>
    </mt:if>
  </div>
<mt:if name="query">
  <div class="full<mt:unless name="list_items"> box-no-list-items"</mt:unless>">
  <mt:var name="search_box">
  </div>
<script>
var in_search = false;
<mt:var name="setup_search">
</script>
  <mt:else>
    <mt:if name="current_filter">
      <mt:var name="current_filter">
    </mt:if>
</mt:if>
</form>
<mt:setvar name="model" value="$_this_model">
<mt:if name="request.dialog_view">
  <button id="dialog-cancel-btn" class="btn btn-secondary" type="submit"><mt:trans phrase="Cancel"></button>
<script>
$('#dialog-cancel-btn').click(function(){
    window.location.href = '<mt:var name="script_uri">?__mode=loading';
    window.parent.$('#modal').modal('hide');
    return false;
});
</script>
</mt:if>
<mt:else>
<mt:setvarblock name="table_header">
<tr>
<mt:unless name="request.workspace_select">
<mt:unless name="request.dialog_view">
<mt:if name="can_delete">
  <mt:setvar name="has_actions" value="1">
<mt:else>
  <mt:unless name="request.workspace_id">
    <mt:if name="can_delete_any">
      <mt:setvar name="has_actions" value="1">
    </mt:if>
  </mt:unless>
</mt:if>
</mt:unless>
<th class="id">
<mt:unless name="_single_select">
<mt:setvar name="show_cb_all_select" value="0">
<mt:if name="list_actions">
  <mt:setvar name="show_cb_all_select" value="1">
  <mt:setvar name="has_actions" value="1">
<mt:elseif name="has_actions">
  <mt:setvar name="show_cb_all_select" value="1">
<mt:elseif name="request.dialog_view">
  <mt:setvar name="show_cb_all_select" value="1">
</mt:if>
<mt:if name="show_cb_all_select">
<label class="custom-control custom-checkbox">
  <input type="checkbox" class="selector custom-control-input cb-all-select"
    aria-label="<mt:trans phrase="Select all">">
  <span class="custom-control-indicator"></span>
  <span class="custom-control-description"></span>
</label>
</mt:if>
</mt:unless>
</th>
</mt:unless>
<mt:loop name="list_cols">
<mt:ifinarray value="$_name" array="$show_cols">
<th class="<mt:if name="_name" eq="id">id<mt:else><mt:if name="_type" ne="relation"><mt:if name="_list" eq="primary">primary<mt:elseif name="_list" like="num">num</mt:if><mt:else>not-primary</mt:if></mt:if>" <mt:if name="_name" eq="rev_diff"> style="width:45%"<mt:elseif name="_name" eq="order"> style="width:100px"</mt:if>>
  <mt:property name="list_header_truncate" setvar="truncate">
  <mt:if name="truncate">
  <mt:setvar name="truncate" value="+..." append="1">
  <mt:else>
  <mt:setvar name="truncate" value="10+...">
  </mt:if>
  <mt:var name="_label" trim_to="$truncate" setvar="_truncated_label">
  <mt:if name="_label" eq="$_truncated_label">
    <mt:var name="_truncated_label" escape>
  <mt:else>
    <span data-toggle="tooltip" data-placement="right" title="<mt:var name="_label" escape>"><mt:var name="_truncated_label" escape></span>
  </mt:if>
  <mt:if name="_name" eq="rev_diff"><mt:trans phrase="Change Note"></mt:if>
  <mt:if name="_type" ne="relation">
    <span class="text-sm toggle">
    <mt:setvar name="class_asc" value="">
    <mt:setvar name="class_desc" value="">
    <mt:if name="request.sort" eq="$_name">
      <mt:if name="request.direction" eq="asc">
        <mt:setvar name="class_asc" value="1">
      <mt:elseif name="request.direction" eq="desc">
        <mt:setvar name="class_desc" value="1">
      </mt:if>
    </mt:if>
  <mt:unless name="request.revision_select">
    <a aria-label="<mt:trans phrase="Sort by %s in %s" params="'$_label','$order_asc'" escape><mt:if name="class_asc">(<mt:trans phrase="Selected">)</mt:if>" class="<mt:if name="class_asc">current-cnd</mt:if>" href="<mt:var name="this_url">&amp;sort=<mt:var name="_name">&amp;direction=asc<mt:var name="query_cond"><mt:var name="workspace_param"><mt:var name="dialog_param"><mt:var name="filter_cond" strip_linefeeds="1"><mt:var name="insert_cond" strip_linefeeds="1"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="filter_add_params"><mt:var name="selector_cond">">&#9650;</a>
    <a aria-label="<mt:trans phrase="Sort by %s in %s" params="'$_label','$order_desc'" escape><mt:if name="class_asc">(<mt:trans phrase="Selected">)</mt:if>" class="<mt:if name="class_desc">current-cnd</mt:if>" href="<mt:var name="this_url">&amp;sort=<mt:var name="_name">&amp;direction=desc<mt:var name="query_cond"><mt:var name="workspace_param"><mt:var name="dialog_param"><mt:var name="filter_cond" strip_linefeeds="1"><mt:var name="insert_cond" strip_linefeeds="1"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="filter_add_params"><mt:var name="selector_cond">">&#9660;</a></span>
  </mt:unless>
  </mt:if>
</th>
</mt:ifinarray>
</mt:loop>
</tr>
<mt:unless name="_single_select">
  <mt:if name="list_from" ne="1">
    <mt:setvar name="show_all_selected" value="1">
  </mt:if>
  <mt:if name="list_to" ne="$object_count">
    <mt:setvar name="show_all_selected" value="1">
  </mt:if>
  <mt:if name="request.insert_editor">
    <mt:setvar name="show_all_selected" value="0">
  </mt:if>
  <mt:unless name="editable_count">
      <mt:setvar name="show_all_selected" value="0">
  </mt:unless>
  <mt:if name="show_all_selected">
  <tr>
    <td colspan="<mt:var name="list_colspan">" class="all-selected-cell">
<label class="custom-control custom-checkbox" style="display:block;">
  <input type="checkbox" class="custom-control-input cb-all-selected" name="all_selected" value="1">
  <span class="custom-control-indicator"></span>
  <span class="custom-control-description"></span>
    &nbsp; <mt:trans phrase="Select all %s items" params="$editable_count">
    <mt:property name="max_batch_actions" setvar="max_batch_actions">
    <mt:if name="max_batch_actions"><mt:if name="editable_count" gt="$max_batch_actions">(<mt:trans phrase="Maximum number of executions is %s" params="$max_batch_actions">)</mt:if></mt:if>
</label>
    </td>
<script>
$('.all-selected-cell').hide();
</script>
  </tr>
</mt:if>
</mt:unless>
</mt:setvarblock>
<table class="full table-sm list-actions-table">
<tr>
<td class="list-actions-col">
<mt:if name="can_action">
<mt:unless name="request.dialog_view">
<mt:setvarblock name="delete_button">
  <button type="button" class="__delete list-delete-btn btn btn-secondary btn-sm">
  <i class="fa fa-trash" aria-hidden="true"></i>
  <span class="sr-only"><mt:trans phrase="Delete"></span>
  </button>
</mt:setvarblock>
<mt:if name="can_delete">
  <mt:var name="delete_button">
<mt:else>
  <mt:unless name="request.workspace_id">
    <mt:if name="can_delete_any">
      <mt:var name="delete_button">
    </mt:if>
  </mt:unless>
</mt:if>
</mt:unless>
<mt:unless name="request.dialog_view">
<mt:if name="list_actions">
  <mt:include file="include/list_actions.tmpl">
</mt:if>
</mt:unless>
<mt:if name="_sortable">
  <button type="submit" class="__save_order save-order-btn btn btn-secondary btn-sm"><mt:trans phrase="Save Order"></button>
</mt:if>
</mt:if>
<mt:var name="search_box">
<script>
var $win = $(window);
var windowWidth = window.innerWidth;
if ( windowWidth > 768 ) {
    $('.alt-search-button').hide();
} else {
    $('.alt-search-button').show();
}
</script>
</td>
<mt:setvarblock name="pagenation_cell">
<td class="pagination-col">
<mt:if name="_per_page">
<nav aria-label="<mt:trans phrase="Page navigation">" class="pull-right">
</mt:if>
  <ul class="pagination pagination-sm">
<mt:if name="has_prev">
  <mt:if name="prev_offset">
    <li class="page-item">
      <a title="<mt:trans phrase="First">" class="page-link" href="<mt:if name="has_prev"><mt:var name="this_url"><mt:var name="sort_cond"><mt:var name="query_cond"><mt:var name="dialog_param"><mt:var name="filter_cond" strip_linefeeds="1"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="filter_add_params"><mt:var name="selector_cond"><mt:var name="insert_cond" strip_linefeeds="1"><mt:var name="revision_cond" strip_linefeeds="1"><mt:else>#</mt:if>" aria-label="<mt:trans phrase="First">">
        <i style="margin: auto -1px" class="fa fa-angle-double-left" aria-hidden="true"></i>
        <span class="sr-only"><mt:trans phrase="First"></span>
      </a>
    </li>
  </mt:if>
</mt:if>
    <li class="page-item <mt:unless name="has_prev">disabled</mt:unless>">
      <a title="<mt:trans phrase="Previous">" class="page-link" href="<mt:if name="has_prev"><mt:var name="this_url">&amp;offset=<mt:var name="prev_offset"><mt:var name="sort_cond"><mt:var name="query_cond"><mt:var name="dialog_param"><mt:var name="filter_cond" strip_linefeeds="1"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="filter_add_params"><mt:var name="selector_cond"><mt:var name="insert_cond" strip_linefeeds="1"><mt:var name="revision_cond" strip_linefeeds="1"><mt:else>#</mt:if>" aria-label="<mt:trans phrase="Previous">">
        <i style="margin: auto 1px" class="fa fa-angle-left" aria-hidden="true"></i>
        <span class="sr-only"><mt:trans phrase="Previous"></span>
      </a>
    </li>
    <li class="page-item <mt:unless name="next_offset">disabled</mt:unless>">
      <a title="<mt:trans phrase="Next">" class="page-link" href="<mt:if name="next_offset"><mt:var name="this_url">&amp;offset=<mt:var name="next_offset"><mt:var name="sort_cond"><mt:var name="query_cond"><mt:var name="dialog_param"><mt:var name="filter_cond" strip_linefeeds="1"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="filter_add_params"><mt:var name="selector_cond"><mt:var name="insert_cond" strip_linefeeds="1"><mt:var name="revision_cond" strip_linefeeds="1"><mt:else>#</mt:if>" aria-label="<mt:trans phrase="Next">">
        <i style="margin: auto 1px" class="fa fa-angle-right" aria-hidden="true"></i>
        <span class="sr-only"><mt:trans phrase="Next"></span>
      </a>
    </li>
<mt:if name="last_offset">
    <li class="page-item">
      <a title="<mt:trans phrase="Last">" class="page-link" href="<mt:var name="this_url">&amp;offset=<mt:var name="last_offset"><mt:var name="sort_cond"><mt:var name="query_cond"><mt:var name="dialog_param"><mt:var name="filter_cond" strip_linefeeds="1"><mt:var name="selected_ids_cond" strip_linefeeds="1"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="filter_add_params"><mt:var name="selector_cond"><mt:var name="insert_cond" strip_linefeeds="1"><mt:var name="revision_cond" strip_linefeeds="1">" aria-label="<mt:trans phrase="Last">">
        <i style="margin: auto -1px" class="fa fa-angle-double-right" aria-hidden="true"></i>
        <span class="sr-only"><mt:trans phrase="Last"></span>
      </a>
    </li>
</mt:if>
  </ul>
</nav>
</mt:if>
<mt:if name="_per_page">
<div class="pull-right page-current">
  <mt:trans phrase="%s - %s of %s Items" params="'$list_from','$list_to','$object_count'">
</div>
</mt:if>
</td>
</mt:setvarblock>
<mt:var name="pagenation_cell">
</tr>
<tr><td colspan="3">
  <mt:var name="current_filter">
</td></tr>
</table>

<mt:loop name="list_items">
<mt:if name="__first__">
<table class="table table-striped table-sm listing-table table-hover <mt:if name="_sortable">listing-table_sortable</mt:if>">
<thead>
<mt:var name="table_header">
</thead>
<tbody id="list_body">
</mt:if>
<tr id="line_<mt:var name="id">"<mt:if name="_this_model" eq="log"><mt:if name="level" eq="4"> style="background-color:#fee;color:#b00"<mt:elseif name="level" eq="8"> style="background-color:#fee;color:#b00"</mt:if></mt:if>>
<mt:setvar name="column_vars" value="">
<mt:loop name="list_cols">
<mt:if name="__first__">
<mt:unless name="request.workspace_select">
<td>
  <mt:setvar name="has_checkbox" value="">
  <mt:unless name="status">
    <mt:setvar name="has_checkbox" value="1">
  <mt:else>
    <mt:if name="status" le="$_max_status">
      <mt:setvar name="has_checkbox" value="1">
    <mt:elseif name="request.dialog_view">
      <mt:setvar name="has_checkbox" value="1">
    </mt:if>
  </mt:unless>
  <mt:unless name="request.dialog_view">
    <mt:tablehascolumn model="$_this_model" column="workspace_id">
    <mt:ifusercan model="$_this_model" action="delete" workspace_id="$workspace_id">
      <mt:setvar name="has_checkbox" value="1">
    <mt:else>
      <mt:setvar name="has_checkbox" value="$actions_count">
    </mt:ifusercan>
    </mt:tablehascolumn>
  </mt:unless>
  <mt:unless name="_single_select">
  <mt:setvarblock name="selector_checkbox">
    <label class="custom-control custom-checkbox">
      <input id="box_<mt:var name="id">" type="checkbox" name="id[]"
        value="<mt:var name="id">" class="custom-control-input"
        aria-label="<mt:trans phrase="Select or deselect %s in this row." params="$label" escape>">
      <span class="custom-control-indicator"></span>
      <span class="custom-control-description"></span>
    </label>
  </mt:setvarblock>
  <mt:if name="has_checkbox">
    <mt:ifusercan action="edit" model="$this_model" id="$id" workspace_id="$workspace_id">
      <mt:var name="selector_checkbox">
    <mt:elseif name="request.dialog_view">
      <mt:var name="selector_checkbox">
    <mt:elseif name="menu_type" eq="3">
      <mt:ifusercan action="update_all" model="$this_model" workspace_id="$workspace_id">
      <mt:setvar name="show_detail_link" value="1">
      <mt:if name="has_actions">
        <mt:var name="selector_checkbox">
      </mt:if>
      </mt:ifusercan>
    </mt:ifusercan>
  <mt:elseif name="menu_type" eq="3">
    <mt:ifusercan action="update_all" model="$this_model" workspace_id="$workspace_id">
    <mt:setvar name="show_detail_link" value="1">
    <mt:if name="has_actions">
      <mt:var name="selector_checkbox">
    </mt:if>
    </mt:ifusercan>
  </mt:if>
  <mt:else>
    <label class="custom-control custom-radio">
      <input type="radio" id="box_<mt:var name="id">" name="id" value="<mt:var name="id">" class="custom-control-input">
      <span class="custom-control-indicator"></span>
      <span class="custom-control-description"></span>
    </label>
  </mt:unless>
</td>
</mt:unless>
</mt:if>
<mt:ifinarray value="$_name" array="$show_cols">
<td <mt:if name="_list" eq="primary"><mt:if name="_icon">style="line-height:1.6em;"</mt:if></mt:if> class="<mt:if name="_name" eq="id">id </mt:if><mt:if name="_list" eq="number"><mt:unless name="sort_order"><mt:if name="_name" ne="status">num</mt:if></mt:unless></mt:if> list-col<mt:if name="_list" eq="primary">-primary primary<mt:else> not-primary</mt:if>">
  <mt:if name="_list" eq="primary">
  <mt:if name="_get_col">
    <mt:var name="$_get_col" escape setvar="_get_col_value">
    <mt:if name="request.from_obj" eq="group">
      <mt:if name="_has_file">
        <mt:setvarblock name="_get_col_value" prepend="1">
        <div class="assets-child-thumb mr-2 mt-0" data-model="<mt:var name="this_model">" data-id="<mt:var name="id">" style="margin-top: -5px !important;background-image:url('<mt:var name="script_uri">?__mode=get_thumbnail&amp;square=1&amp;_model=<mt:var name="this_model">&amp;id=<mt:var name="id">')"></div>
        </mt:setvarblock>
      </mt:if>
        <mt:setvarblock name="_get_col_value" append="1">
          <mt:if name="_status_text">
          <span class="badge badge-status ml-2" style="background-color:white;color:black"> <mt:var name="_status_text"> </span>
          </mt:if>
        </mt:setvarblock>
      </mt:if>
    </mt:if>
    <mt:if name="this_model" eq="urlinfo">
      <mt:if name="request.target" eq="urls">
        <mt:var name="_model_primary" escape setvar="_get_col_value">
      </mt:if>
    </mt:if>
    <input type="hidden" id="_get_col_<mt:var name="id">" value="<mt:var name="_get_col_value" escape>">
  </mt:if>
  </mt:if>
<mt:setvarblock name="col_content">
  <mt:var name="_name" escape setvar="__col_name__">
<mt:isarray name="$_name">
  <mt:var name="$_name" setvar="__col_values__">
    <mt:setvar name="__escaped_values" value="">
  <mt:loop name="__col_values__">
    <mt:var name="__value__" escape setvar="__escaped_value">
    <mt:setvar name="__escaped_values" value="$__escaped_value" function="push">
  </mt:loop>
  <mt:var name="__escaped_values" setvar="__col_values__">
<mt:else>
  <mt:var name="$_name" escape setvar="__col_value__">
</mt:isarray>
  <mt:setvarblock name="include_path">include/list/<mt:var name="this_model">/column_<mt:var name="_name">.tmpl</mt:setvarblock>
  <mt:include file="$include_path" setvar="alt_value">
  <mt:unless name="alt_value">
    <mt:setvarblock name="include_path">include/list/column_<mt:var name="_name">.tmpl</mt:setvarblock>
    <mt:include file="$include_path" setvar="alt_value">
  </mt:unless>
  <mt:if name="alt_value">
    <mt:var name="alt_value">
  <mt:else>
    <mt:isarray name="$_name">
      <mt:var name="$_name" join=", " escape>
    <mt:else>
      <mt:setvar name="_can_sort" value="0">
      <mt:if name="_name" eq="order">
      <mt:if name="_sortable">
        <mt:setvar name="_can_sort" value="1">
      </mt:if>
      </mt:if>
      <mt:if name="_list" eq="primary">
        <mt:setvar name="_pull_back" value="0">
        <mt:setvar name="show_edit_link" value="0">
        <mt:ifusercan action="edit" model="$this_model" id="$id" workspace_id="$workspace_id">
          <mt:setvar name="show_edit_link" value="1">
        <mt:elseif name="show_detail_link">
          <mt:setvar name="show_edit_link" value="1">
        <mt:elseif name="_has_workflow">
          <mt:if name="can_pull_back">
            <mt:if name="_previous_owner">
              <mt:if name="_previous_owner" eq="$_admin_user_id">
                <mt:if name="max_status" lt="2">
                  <mt:if name="status" lt="3">
                    <mt:setvar name="_pull_back" value="1">
                  </mt:if>
                </mt:if>
              </mt:if>
            </mt:if>
          </mt:if>
        </mt:ifusercan>
        <mt:if name="request.dialog_view"><mt:if name="request.workflow_model">
          <mt:setvar name="show_edit_link" value="0">
        </mt:if></mt:if>
        <mt:if name="_has_file">
          <mt:if name="_icon">
          <div class="list-icon">
          <a href="javascript:void(0);" id="popover-list-<mt:var name="id">">
          <img src="<mt:var name="prototype_path">assets/img/spacer.gif"
          style="background-image:url('<mt:var name="prototype_path">assets/img/loading.gif');background-size:25px;background-repeat:no-repeat;background-position:center center;"
          class="lazy" data-original="<mt:var name="_icon" escape>" width="32" alt="<mt:trans phrase="$_icon_class">"> 
          </a>
          <script>
          $('#popover-list-<mt:var name="id">').popover({
              content: "<img src='<mt:var name="_icon_large">' alt='<mt:trans phrase="Preview">' width='150'>",
              placement: "right",
              html: true
          });
          $('body').on('click', function (e) {
              $('#popover-list-<mt:var name="id">').popover('hide');
          });
          </script>
            <mt:if name="_get_col">
            <input type="hidden" id="_get_col_img_<mt:var name="id">" value="<mt:var name="_icon">">
            </mt:if>
          </div>
          <mt:else>
            <input type="hidden" id="_get_col_img_<mt:var name="id">" value="<mt:var name="script_uri">?__mode=get_thumbnail&amp;square=1&amp;id=<mt:var name="id">&amp;_model=<mt:var name="this_model" escape>">
            <span class="list-file-icon">
            <i class="fa-2x list-small-icon fa <mt:if name="_icon_class" eq="image">fa-file-image-o<mt:elseif name="_icon_class" eq="pdf">fa-file-pdf-o<mt:elseif name="_icon_class" eq="video">fa-file-video-o<mt:elseif name="_icon_class" eq="audio">fa-file-audio-o<mt:elseif name="_icon_class" eq="archive">fa-file-archive-o<mt:else><mt:unless name="_icon_class">fa-minus<mt:else>fa-file-o</mt:unless></mt:if>" aria-hidden="true"></i>
            </span>
            <span class="sr-only"><mt:trans phrase="$_icon_class"></span>
          </mt:if>
        </mt:if>
        <mt:ifusercan action="list" model="$this_model" workspace_id="$workspace_id">
          <mt:if name="rev_type">
          <mt:if name="rev_type" eq="1">
            <span class="badge badge-dark badge-pill badge-sm"><mt:trans phrase="Auto Save"></span>
            <mt:else>
            <span class="badge badge-dark badge-pill badge-sm"><mt:trans phrase="Revision"></span>
            </mt:if>
          </mt:if>
          <mt:if name="request.workspace_select">
            <a target="_parent" href="<mt:var name="script_uri">?__mode=dashboard&amp;workspace_id=<mt:var name="id" escape>">
          <mt:else>
            <mt:if name="this_model" eq="role">
              <mt:if name="request.dialog_view">
                <mt:setvar name="show_edit_link" value="0">
              </mt:if>
            </mt:if>
            <mt:if name="show_edit_link">
              <a id="edit-link-<mt:var name="id" escape>" <mt:unless name="request.workspace_select"><mt:else>target="_parent"</mt:unless> href="<mt:var name="script_uri">?__mode=<mt:unless name="request.workspace_select">view&amp;_type=edit&amp;_model=<mt:var name="this_model" escape>&amp;id=<mt:var name="id" escape><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:if name="_this_model" eq="workspace">&amp;workspace_id=<mt:var name="id" escape></mt:if><mt:if name="request.revision_select">&amp;edit_revision=1<mt:if name="request.dialog_view">&amp;rev_object_id=<mt:var name="request.rev_object_id" escape></mt:if></mt:if><mt:else>dashboard&amp;workspace_id=<mt:var name="id" escape></mt:unless><mt:if name="request.dialog_view"><mt:var name="dialog_param"><mt:if name="request.target">&amp;target=<mt:var name="request.target" escape>&amp;get_col=<mt:var name="request.get_col" escape><mt:if name="request.single_select">&amp;single_select=1</mt:if><mt:if name="request.selected_ids">&amp;selected_ids=<mt:var name="request.selected_ids" escape></mt:if><mt:if name="request.select_add">&amp;select_add=<mt:var name="request.select_add" escape></mt:if><mt:elseif name="request.insert_editor">&amp;select_system_filters=<mt:var name="request.select_system_filters" escape>&amp;_system_filters_option=<mt:var name="request._system_filters_option" escape>&amp;_filter=<mt:var name="request._filter" escape>&amp;insert_editor=<mt:var name="request.insert_editor" escape>&amp;insert=<mt:var name="request.insert" escape></mt:if></mt:if><mt:if name="request.any_model">&amp;any_model=1</mt:if><mt:if name="request._from_scope">&amp;_from_scope=<mt:var name="request._from_scope" escape></mt:if>">
            </mt:if>
          </mt:if>
        </mt:ifusercan>
          <mt:if name="$_name" eq="">
            null(id:<mt:var name="id">)
          <mt:else>
            <mt:var name="$_name" escape>
          </mt:if>
          <mt:if name="request.workspace_select">
            </a>
          <mt:else>
            <mt:if name="show_edit_link">
              </a>
            </mt:if>
          </mt:if>
          <mt:if name="rev_type">
          <mt:if name="status_published">
            &nbsp; <span style="margin-right: -2px"><mt:statustext status="$status" model="$this_model" icon_only="1" icon="1"></span>
          </mt:if>
          </mt:if>
          <mt:unless name="request.revision_select">
          <mt:unless name="request.workspace_select"><mt:unless name="request.workflow_model">
          <mt:if name="can_revision">
            <mt:if name="allow_revision_in_list">
              <mt:if name="status" le="$max_status_for_create_revision">
          &nbsp;
          <a data-toggle="tooltip" data-placement="top" class="create_revision" title="<mt:trans phrase="Create Revision">" href="<mt:var name="script_uri">?__mode=clone_object&amp;_model=<mt:var name="this_model" escape><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if>&amp;id=<mt:var name="id" escape>&amp;as_revision=1"><i class="fa fa-code-fork"></i><span class="sr-only"><mt:trans phrase="Create Revision"></span></a>
              </mt:if>
            </mt:if>
          </mt:if>
          <mt:if name="can_duplicate">
          &nbsp;
          <a class="clone_object" data-toggle="tooltip" data-placement="top" title="<mt:trans phrase="Duplicate">" href="<mt:var name="script_uri">?__mode=clone_object&amp;_model=<mt:var name="this_model" escape><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if>&amp;id=<mt:var name="id" escape>"><i class="fa fa-clone"></i><span class="sr-only"><mt:trans phrase="Duplicate"></span></a>
          </mt:if></mt:unless></mt:unless>
          <mt:if name="_pull_back">
            &nbsp;
            <mt:var name="_workflow_notify_changes" setvar="_workflow_notify">
            <mt:if name="user_id" eq="$_unspecified">
              <mt:var name="_workflow_notify" value="0">
            </mt:if>
            <mt:if name="_workflow_notify">
              <span data-placement="top" data-toggle="tooltip" data-placement="top" title="<mt:trans phrase="Pull Back">">
              <button class="pull_back-btn" type="button" data-toggle="modal" data-target="#modal" data-href="<mt:var name="script_uri">?__mode=pull_back&amp;_model=<mt:var name="this_model" escape><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if>&amp;id=<mt:var name="id" escape>&amp;user_id=<mt:var name="_user_id">&amp;dialog_view=1">
              <i class="fa fa-hand-o-left" aria-hidden="true"></i><span class="sr-only"><mt:trans phrase="Pull Back"></span>
              </button>
              </span>
            <mt:else>
              <button type="button" data-placement="top" class="pull_back pull_back-btn" data-toggle="tooltip" data-placement="top" title="<mt:trans phrase="Pull Back">" data-href="<mt:var name="script_uri">?__mode=pull_back&amp;_model=<mt:var name="this_model" escape><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if>&amp;id=<mt:var name="id" escape>&amp;user_id=<mt:var name="_user_id">">
              <i class="fa fa-hand-o-left" aria-hidden="true"></i><span class="sr-only"><mt:trans phrase="Pull Back"></span>
              </button>
            </mt:if>
          </mt:if>
        <mt:unless name="request.manage_revision">
        <mt:if name="_permalink">
          &nbsp; &nbsp;
          <a data-toggle="tooltip" data-placement="top" id="permalink_<mt:var name="id">" title="<mt:trans phrase="View">" href="<mt:var name="_permalink">" target="_blank">
          <i class="fa fa-external-link" aria-hidden="true"></i>
          <span class="sr-only"><mt:trans phrase="View"></span>
          </a>
        <mt:if name="_show_both">
        &nbsp;
          <mt:var name="_permalink" replace="'$_site_url','$_link_url'" setvar="__permalink">
          <a data-toggle="tooltip" data-placement="top" id="linkurl_<mt:var name="id">" style="position:absolute;margin-top:-1px" title="<mt:trans phrase="View Published">" href="<mt:var name="__permalink">" target="_blank">
          <i class="fa fa-globe" aria-hidden="true"></i>
          <span class="sr-only"><mt:trans phrase="View Published"></span>
          </a>
        </mt:if>
        </mt:if>
        </mt:unless>
        </mt:unless>
          <a class="btn toggle-infobox hidden"
            id="toggle_<mt:var name="id">" href="javascript:void(0);">
            <i id="toggle_icn_<mt:var name="id">" class="fa fa-caret-down toggle-icn" aria-hidden="true"></i>
            <span class="sr-only"><mt:trans phrase="Toggle"></span>
          </a>
          <div id="infobox_<mt:var name="id">" class="hidden info-box"></div>
      <mt:elseif name="_list" eq="url">
        <mt:var name="$_name" escape setvar="_url_value"><mt:var name="_url_value">
        <mt:if name="_url_value" match="/^https?:\/\//">
          <a href="<mt:var name="_url_value">" target="_blank"><i class="fa fa-external-link" aria-hidden="true"></i>
          <span class="sr-only"><mt:trans phrase="Open in new window"></span></a>
        </mt:if>
      <mt:elseif name="_list" eq="checkbox">
        <mt:if name="$_name">
          <i class="fa fa-check-square-o" aria-hidden="true"></i>
          <span class="sr-only"><mt:trans phrase="Checked"></span>
        </mt:if>
      <mt:elseif name="_list" like=":">
        <mt:if name="_name" eq="workspace_id">
          <mt:unless name="workspace_scope">
            <a href="<mt:var name="this_url"><mt:var name="sort_cond"><mt:var name="query_cond"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if><mt:var name="dialog_param"><mt:var name="selector_cond">"><mt:var name="workspace_name" escape></a>
          </mt:unless>
        <mt:else>
          <mt:var name="$_name" escape>
        </mt:if>
      <mt:elseif name="_name" eq="status">
        <mt:var name="$_name" setvar="status">
        <mt:var name="_status_text">
      <mt:elseif name="_list" eq="popover">
        <button id="popover-<mt:var name="_name">-<mt:var name="id">" type="button" class="btn btn-secondary btn-sm" data-container="body" data-toggle="popover" data-placement="left">
        <i class="fa fa-commenting-o" aria-hidden="true"></i>
        <span class="sr-only"><mt:trans phrase="Toggle"></span>
        </button>
<script>
$('#popover-<mt:var name="_name">-<mt:var name="id">').popover({
    title: '<mt:var name="_label" escape>',
    content: '<mt:var name="$_name" encode_js="1" trim_to="600+...">',
    placement: "bottom",
    html: true
});
</script>
      <mt:elseif name="_can_sort">
        <input name="order_<mt:var name="id">" type="number" class="form-control order_col form-control-sm" value="<mt:var name="$_name" escape>">
      <mt:else>
        <mt:var name="$_name" escape>
      </mt:if>
    </mt:isarray>
  </mt:if>
</mt:setvarblock>
<mt:var name="col_content">
<mt:if name="_list" ne="primary">
<mt:unless name="_can_sort">
  <mt:if name="_name" ne="$__last_col__">
    <mt:setvarblock name="column_vars" append="1">
      <tr><th><mt:var name="_label"></th><td><mt:var name="col_content"></td></tr>
    </mt:setvarblock>
  </mt:if>
</mt:unless>
</mt:if>
<mt:setvar name="__last_col__" value="$_name">
<mt:if name="__counter__" eq="1">
  <mt:if name="_no_primary">
    <a <mt:if name="request.dialog_view">target="_blank"</mt:if> href="<mt:var name="script_uri">?__mode=view&amp;_type=edit&amp;_model=<mt:var name="this_model" escape>&amp;id=<mt:var name="id" escape><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if>">
    (<mt:trans phrase="Edit">)
    </a>
  </mt:if>
</mt:if>
</td>
</mt:ifinarray>
</mt:loop>
<td class="hidden" id="detail_<mt:var name="id">">
  <table class="cell-detail table-sm">
    <mt:var name="column_vars">
  </table>
</td>
</tr>
<mt:if name="__last__">
</tbody>
<tfoot>
<mt:var name="table_header">
</tfoot>
</table>
</mt:if>
</mt:loop>
<mt:setvarblock name="include_path">include/list/<mt:var name="model">/list_footer.tmpl</mt:setvarblock>
<mt:include file="$include_path">
<table class="full table-sm list-actions-table">
<tr>
<td class="list-actions-col">
<mt:if name="can_action">
<mt:unless name="request.dialog_view">
<mt:setvarblock name="delete_button">
  <button type="button" class="__delete list-delete-btn btn btn-secondary btn-sm">
  <i class="fa fa-trash" aria-hidden="true"></i>
  <span class="sr-only"><mt:trans phrase="Delete"></span>
  </button>
</mt:setvarblock>
<mt:if name="can_delete">
  <mt:var name="delete_button">
<mt:else>
  <mt:unless name="request.workspace_id">
    <mt:if name="can_delete_any">
      <mt:var name="delete_button">
    </mt:if>
  </mt:unless>
</mt:if>
</mt:unless>
<mt:unless name="request.dialog_view">
<mt:if name="list_actions">
  <mt:include file="include/list_actions.tmpl" disp_action_bar="1">
</mt:if>
</mt:unless>
<mt:if name="_sortable">
  <button type="submit" class="__save_order save-order-btn btn btn-secondary btn-sm"><mt:trans phrase="Save Order"></button>
</mt:if>
</mt:if>
<mt:var name="search_box">
</td>
<mt:var name="pagenation_cell">
</tr>
<tr><td colspan="3">
  <mt:var name="current_filter">
</td></tr>
</table>
</form>
<mt:unless name="request.workspace_select">
<mt:if name="request.dialog_view">
<mt:if name="user_stickey_buttons"></div></mt:if>
<div class="mb-5 <mt:if name="user_stickey_buttons">pl-3</mt:if> edit-action-bar full">
<mt:if name="request.dialog_view"><mt:if name="debug_mode"><div class="mb-5"></mt:if></mt:if>
  <button id="dialog-cancel-btn" class="btn btn-secondary" type="button"><mt:trans phrase="Cancel"></button>
  <button id="dialog-selector-btn<mt:if name="request.insert_editor">-editor_insert</mt:if>" class="btn btn-primary" type="button"><mt:trans phrase="Select"></button>
<mt:if name="request.dialog_view"><mt:if name="debug_mode"></div></mt:if></mt:if>
</div>
<mt:if name="user_stickey_buttons"><div class="col-md-12"></mt:if>
</mt:if>
</mt:unless>
<script>
var $win = $(window);
$('.toggle-infobox').click(function(){
    this_id = $(this).prop('id');
    this_id = this_id.replace( /toggle_/, '' );
    if (! $('#infobox_' + this_id).html() ) {
        $('#infobox_' + this_id).html( $('#detail_' + this_id).html() );
        $('#infobox_' + this_id).show();
        $('#toggle_icn_' + this_id).removeClass('fa-caret-down');
        $('#toggle_icn_' + this_id).addClass('fa-caret-up');
    } else {
        $('#infobox_' + this_id).html('');
        $('#infobox_' + this_id).hide();
        $('#toggle_icn_' + this_id).removeClass('fa-caret-up');
        $('#toggle_icn_' + this_id).addClass('fa-caret-down');
    }
});
<mt:if name="request.dialog_view">
$(document).keydown(evnt_keydown);
function evnt_keydown(e) {
    if ( e.keyCode == 27 ) {
        window.location.href = '<mt:var name="script_uri">?__mode=loading';
        window.parent.$('#modal').modal('hide');
    }
}
</mt:if>
$(":checkbox").keypress(function(e) {
    if ( e.keyCode == 13 ) {
        if ( $(this).prop('checked') ) {
            $(this).prop('checked', false);
        } else {
            $(this).prop('checked', true);
        }
        if ( $(this).hasClass('cb-all-select') ) {
            checked = $(this).prop('checked');
            $("input[name='id[]']").each(function(){
                $(this).prop('checked', checked);
            });
            $('.selector').prop('checked', checked);
            <mt:if name="show_all_selected">
                if ( checked ) {
                    $('.all-selected-cell').show();
                } else {
                    $('.all-selected-cell').hide();
                    $('.cb-all-selected').prop('checked', false);
                }
            </mt:if>
            <mt:if name="request.dialog_view">
              <mt:unless name="request.revision_select">
                <mt:unless name="_single_select">
                set_selected_cbs();
                </mt:unless>
              </mt:unless>
            </mt:if>
        } else {
            set_all_select();
        }
    }
    return false;
});
var in_link = false;
$('a').mouseover(function() {
    in_link = true;
});
$('a').click(function() {
    in_link = true;
});
$('a').mouseout(function() {
    in_link = false;
});
<mt:if name="_single_select">
$('input').click(function() {
    in_link = true;
});
</mt:if>
$('input').mouseover(function() {
    in_link = true;
});
$('input').mouseout(function() {
    in_link = false;
});
$('#list_body tr').click(function() {
    if ( in_link ) {
        return true;
    }
    line_id = $(this).prop('id');
    line = line_id.replace( /line_/, '' );
    checked = $('#box_'+line).prop('checked');
    if ( checked ) {
        $('#box_'+line).prop('checked', false);
    } else {
        $('#box_'+line).prop('checked', true);
    }
    set_all_select();
});
<mt:if name="_sortable">
$('#list_body tr').mouseover(function() {
    $(this).css('cursor','move');
});
</mt:if>
var in_search = false;
var selected_ids = [];
var upload_ids = [];
<mt:if name="request.dialog_view">
var target_control;
<mt:unless name="request.revision_select">
$(function(){
    target_control = '<mt:var name="request.target" escape>';
<mt:if name="request.single_select">
    var selected_id = window.parent.$('#'+target_control).val();
    <mt:if name="request.selected_ids">
    <mt:var name="request.selected_ids" split="," setvar="request_selected_ids">
    <mt:loop name="request_selected_ids">
        selected_id = '<mt:var name="__value__">';
    </mt:loop>
    </mt:if>
    $("input[name='id']").each(function(){
        if( $(this).val() == selected_id ) {
            $(this).prop('checked', true);
        }
    });
<mt:else>
    window.parent.$("input[name='"+<mt:if name="request._field_name">'<mt:var name="request._field_name" escape>'<mt:else>target_control</mt:if>+"[]']").each(function(){
        if ( $(this).val() ) {
            selected_ids.push($(this).val());
        }
    });
    <mt:if name="request.selected_ids">
    <mt:var name="request.selected_ids" split="," setvar="request_selected_ids">
    <mt:loop name="request_selected_ids">
        if( $.inArray('<mt:var name="__value__">', selected_ids ) == -1 ) {
            upload_ids.push('<mt:var name="__value__">');
        }
    </mt:loop>
    </mt:if>
    set_selected_cbs();
</mt:if>
});
<mt:if name="request.dialog_view">
  <mt:unless name="request.revision_select">
    <mt:unless name="_single_select">
function set_selected_cbs () {
    $("input[name='id[]']").each(function(){
        if( $.inArray($(this).val(), selected_ids ) != -1 ) {
            $(this).prop('checked', true );
            $('#line_' + $(this).val() ).css('background-color', '#ddd');
            $('#line_' + $(this).val() ).on('click', function() {
                var select_id = $(this).prop('id');
                select_id = select_id.replace( 'line_', '' );
                $("input[name='id[]']").each(function(){
                    if ( $(this).val() == select_id ) {
                        $(this).prop('checked', true );
                    }
                });
            });
        }
        if( $.inArray($(this).val(), upload_ids ) != -1 ) {
            $(this).prop('checked', true );
        }
    });
}
<mt:ignore>
var add_objects = [];
$("input[name='id[]']").change(function(){
    if (! $(this).prop('checked') ) {
        add_objects[$(this).val()] = $('#_get_col_' + $(this).val() ).val();
    } else {
        delete add_objects[$(this).val()];
    }
    window.parent.<mt:var name="request.target">_add_objects = add_objects;
    // parent_add_objects = window.parent.<mt:var name="request.target">_add_objects;
});
</mt:ignore>
    </mt:unless>
  </mt:unless>
</mt:if>
</mt:unless>
$('#dialog-selector-btn-editor_insert').click(function(){
    if ( item_checked() == false ) {
        alert('<mt:trans phrase="You did not select any %s." params="$label">');
        return false;
    }
    $("#__mode").prop('value', 'insert_asset');
    $('#list-select-form').submit();
});
$('#dialog-cancel-btn').click(function(){
    window.location.href = '<mt:var name="script_uri">?__mode=loading';
    window.parent.$('#modal').modal('hide');
    return false;
});
$('#dialog-selector-btn').click(function(){
<mt:if name="request.single_select">
    let selected = $('input[name=id]:checked').val();
    selected = $( '<span/>' ).text(selected).html();
    if (! selected ) {
        alert('<mt:trans phrase="You did not select any %s." params="$label">');
        return false;
    }
  <mt:unless name="request.revision_select">
    let col_value = $('#_get_col_' + selected ).val();
    // col_value = $( '<span/>' ).text(col_value).html();
    window.parent.$('#'+target_control).val(selected);
    window.parent.$('#'+target_control+'-close').show();
    window.parent.$('#'+target_control+'-close').removeClass('hidden');
    window.parent.$('#'+target_control+'-label').html(col_value);
    if ( window.parent.$('#_' + target_control + '-edit-defeult').length ) {
        if ( $('#edit-link-'+selected).length ) {
            window.parent.$('#_' + target_control + '-edit-defeult').show();
            window.parent.$('#_' + target_control + '-edit-defeult').css( 'display', 'inline' );
            window.parent.$('#_' + target_control + '-edit-defeult').removeClass('hidden');
            var dataHref = window.parent.$('#_' + target_control + '-edit-defeult').attr('data-href');
            dataHref = dataHref.replace( /&id=[0-9]*&/, '&id=' + selected + '&' );
            window.parent.$('#_' + target_control + '-edit-defeult').data('href', dataHref);
            window.parent.$('#_' + target_control + '-edit-defeult').attr('href', dataHref);
            window.parent.$('#_' + target_control + '-edit-defeult').attr('data-href', dataHref);
        } else {
            window.parent.$('#_' + target_control + '-edit-defeult').hide();
            window.parent.$('#_' + target_control + '-edit-defeult').addClass('hidden');
        }
    }
    let obj_permalink = $('#permalink_'+selected);
    let obj_linkurl = $('#linkurl_'+selected);
    <mt:if name="this_model" eq="asset">
    window.parent.$('#_'+target_control+'_name').html(col_value);
    let viewLink = window.parent.$('#'+target_control+'-view-asset-link');
    let linkURL = window.parent.$('#'+target_control+'-view-asset-link-url');
    if ( obj_permalink.length ) {
        viewLink.removeClass('hidden');
        viewLink.show();
        let editButton = window.parent.$('#_'+target_control+'-edit');
        editButton.removeClass('hidden');
        editButton.attr('data-label', col_value );
        editButton.show();
        obj_permalink = obj_permalink.attr( 'href' );
        viewLink.attr( 'href', obj_permalink );
        let fInfo = obj_permalink.split('.');
        let fileExtension = fInfo[fInfo.length-1].toLowerCase();
        let extensionsInline = ['csv', 'xls', 'xlsx', 'doc', 'docx', 'ppt', 'pptx'];
        if (extensionsInline.indexOf(fileExtension) < 0){
            viewLink.attr('target', '_blank');
            viewLink.children('i').removeClass('fa-download');
            viewLink.children('i').addClass('fa-external-link-square');
            viewLink.attr('aria-label','<mt:trans phrase="View">');
        }
        let obj_label = window.parent.$('#_'+target_control+'_label');
        if ( obj_label.length ) {
            obj_label.val( col_value );
        }
        if ( obj_linkurl.length ) {
            obj_linkurl = obj_linkurl.attr( 'href' );
            if ( linkURL.length ) {
                linkURL.attr( 'href', obj_linkurl );
                linkURL.removeClass('hidden');
                linkURL.show();
                if (extensionsInline.indexOf(fileExtension) < 0){
                    linkURL.attr('target', '_blank');
                }
            }
        }
    } else {
        viewLink.addClass('hidden');
        viewLink.hide();
    }
    <mt:else>
    window.parent.$('#'+target_control+'-label').html(col_value);
    let thumbDiv = window.parent.$('#'+target_control+'-img');
    if ( thumbDiv.length ) {
        thumbDiv.attr( 'data-id', selected );
        let bgimage = thumbDiv.attr('data-href');
        if ( bgimage ) {
            thumbDiv.css('background-image','url(' + bgimage + selected + ')' );
            thumbDiv.removeClass( 'hidden' );
            thumbDiv.show();
        }
    }
    let viewLink = window.parent.$('.attachment-download-btn-' + target_control );
    let linkURL = window.parent.$('.attachment-linkurl-btn-' + target_control );
    if ( obj_permalink.length ) {
        obj_permalink = obj_permalink.attr( 'href' );
        viewLink.attr( 'href', obj_permalink );
        viewLink.removeClass('hidden');
        viewLink.show();
        if ( obj_linkurl.length ) {
            obj_linkurl = obj_linkurl.attr( 'href' );
            if ( linkURL.length ) {
                linkURL.attr( 'href', obj_linkurl );
                linkURL.removeClass('hidden');
                linkURL.show();
            }
        }
    } else {
        viewLink.addClass('hidden');
        viewLink.hide();
        linkURL.addClass('hidden');
        linkURL.hide();
    }
    </mt:if>
    if ( $('#_get_col_img_' + selected ).length ) {
        let col_img = $('#_get_col_img_' + selected ).val();
        if ( col_img ) {
            // col_img = $( '<span/>' ).text(col_img).html();
            window.parent.$('#'+target_control+'-img').removeClass('hidden');
            window.parent.$('#'+target_control+'-img')
                .attr('data-id',selected)
                .data('id',selected)
                .css('background-image','url(' + col_img + ')')
                .show();
        } else {
            window.parent.$('#'+target_control+'-img').hide();
        }
    }
  <mt:else>
    next_url = '<mt:var name="script_uri">?__mode=view&_type=edit&_model=<mt:var name="this_model">&edit_revision=1&id='+selected<mt:if name="workspace_id">+'&workspace_id=<mt:var name="workspace_id">'</mt:if>;
    window.parent.$('#modal').modal('hide');
    window.parent.location.href = next_url;
    return;
  </mt:unless>
<mt:else>
    if ( in_search ) {
        return true;
    }
    if ( item_checked() == false ) {
        alert('<mt:trans phrase="You did not select any %s." params="$label">');
        return false;
    }
    <mt:if name="request.get_col">
    // all-selected
    if ( $(".cb-all-selected").prop('checked') ) {
        var filter_params = $('#filter_params').val();
        var json_url = '<mt:var name="script_uri">?__mode=view&_type=list&dialog_view=1&_model=<mt:var name="this_model"><mt:ifworkspacemodel model="$this_model"><mt:if name="workspace_id">&amp;workspace_id=<mt:var name="workspace_id"></mt:if></mt:ifworkspacemodel>&to_json=1&all_selected=1&limit=-1';
        $.ajax({
            url: json_url,
            type: 'POST',
            data: {'filter_params' : filter_params,
                   'get_col' : '<mt:var name="request.get_col">'},
            dataType: 'json',
            async: false,
            timeout: 10000,
            success: function( responce ){
                let arr = responce.items;
                arr.forEach(function(object) {
                    let col_value = object.<mt:var name="request.get_col">;
                    let obj_id = object.id;
                    if($('#box_' + obj_id).length){
                    } else {
                        let obj_icon = object._icon;
                        let tline = $('<tr class="hidden"></tr>');
                        tline.attr( 'id', 'line_' + obj_id );
                        let thtml = '<td>';
                        thtml += '<input checked id="box_"' + obj_id + ' type="checkbox" name="id[]" value="' + obj_id + '">';
                        thtml += '<input type="hidden" id="_get_col_' + obj_id +  '" value="' + col_value + '">';
                        if ( obj_icon ) {
                            thtml += '<input type="hidden" id="_get_col_img_' + obj_id +  '" value="' + obj_icon + '">';
                        }
                        thtml += '<a id="edit-link-' + obj_id +  '"  href="<mt:var name="script_uri">?__mode=view&amp;_type=edit&amp;_model=<mt:var name="this_model">&amp;id=' + obj_id + '<mt:var name="dialog_param">&amp;target=<mt:var name="request.target" escape>&amp;get_col=<mt:var name="request.get_col">&amp;select_add=1"></td>';
                        tline.html( thtml );
                        $('#list_body').append( tline );
                    }
                });
            },
            error: function(){
                // error
            }
        });
    }
    </mt:if>
    var checked_ids = [];
    $("input[name='id[]']").each(function(){
        if ( $(this).prop('checked') ) {
            checked_ids.push( $(this).val() );
        }
    });
    var count = checked_ids.length;
  <mt:unless name="request.select_add">
    window.parent.$('.'+target_control+'-child').each(function(){
        $(this).remove();
    });
  </mt:unless>
  <mt:if name="request.ids_only">
    window.parent.$('#'+target_control).val(checked_ids.join(','));
    window.location.href = '<mt:var name="script_uri">?__mode=loading';
    window.parent.$('#modal').modal('hide');
    return; // the if statement is on the template.
  </mt:if>
    for( let i = 0; i < count; i++ ) {
        <mt:if name="request.select_add">
        if( $.inArray(checked_ids[i], selected_ids ) != -1 ) {
            window.parent.$("input[name='"+target_control+"[]']").each(function(){
                if ($(this).val() == checked_ids[i] ) {
                    var col_value = $('#_get_col_' + checked_ids[i] ).val();
                    var innerSpans = $(this).parent().find('span');
                    innerSpans[0].innerHTML = col_value;
                }
            });
            continue;
        }
        </mt:if>
        window.parent.$('#'+target_control+'-none').hide();
        let _li = window.parent.$('#'+target_control+'-tmpl');
        let newli = _li.clone( true ).appendTo('#'+target_control );
        newli.removeClass('hidden');
        let col_value = $('#_get_col_' + checked_ids[i] ).val();
        <mt:var name="request.target" setvar="this_target">
        <mt:if name="this_model" eq="asset">
          <mt:if name="this_target" match="^asset_files\-">
            <mt:setvar name="this_target" value="assets">
          </mt:if>
            <mt:if name="this_target" eq="assets">
            let obj_permalink = $('#permalink_'+checked_ids[i]);
            let obj_linkurl = $('#linkurl_'+checked_ids[i]);
            if ( obj_permalink.length ) {
                obj_permalink = obj_permalink.attr( 'href' );
                newli.children('.asset-download-btn').attr( 'href', obj_permalink );
                let fInfo = obj_permalink.split('.');
                let fileExtension = fInfo[fInfo.length-1].toLowerCase();
                let extensionsInline = ['csv', 'xls', 'xlsx', 'doc', 'docx', 'ppt', 'pptx'];
                if (extensionsInline.indexOf(fileExtension) < 0){
                    newli.children('.asset-download-btn').attr('target', '_blank');
                    newli.children('.asset-download-btn').children('i').removeClass('fa-download');
                    newli.children('.asset-download-btn').children('i').addClass('fa-external-link-square');
                    newli.children('.asset-download-btn').attr('aria-label','<mt:trans phrase="View">');
                }
                if ( obj_linkurl.length ) {
                    obj_linkurl = obj_linkurl.attr( 'href' );
                    newli.children('.asset-linkurl-btn').attr( 'href', obj_linkurl );
                    if (extensionsInline.indexOf(fileExtension) < 0){
                        newli.children('.asset-linkurl-btn').attr('target', '_blank');
                    }
                    newli.children('.asset-linkurl-btn').removeClass('hidden');
                    newli.children('.asset-linkurl-btn').show();
                }
            } else {
                newli.children('.asset-download-btn').hide();
                newli.children('.asset-linkurl-btn').hide();
            }
            newli.children('.insert-file-id').attr('value',checked_ids[i]);
            newli.children('.insert-file-name').attr('value',col_value);
            newli.children('.insert-file-name').attr('id','_' + target_control + '_label_' + checked_ids[i]);
            newli.children('span').attr('id', '_' + target_control + '_name_' + checked_ids[i]);
            let editLink = $('#edit-link-'+checked_ids[i]);
            <mt:else>
                newli.children('input').val( checked_ids[i] );
            </mt:if>
        <mt:else>
            newli.children('input').val( checked_ids[i] );
            let obj_permalink = $('#permalink_'+checked_ids[i]);
            let obj_linkurl = $('#linkurl_'+checked_ids[i]);
            if ( obj_permalink.length ) {
                obj_permalink = obj_permalink.attr( 'href' );
                newli.children('.asset-download-btn').attr( 'href', obj_permalink );
                newli.children('.asset-download-btn').removeClass('hidden');
                if ( obj_linkurl.length ) {
                    obj_linkurl = obj_linkurl.attr( 'href' );
                    newli.children('.asset-linkurl-btn').attr( 'href', obj_linkurl );
                    newli.children('.asset-linkurl-btn').removeClass('hidden');
                    newli.children('.asset-linkurl-btn').show();
                }
            } else {
                newli.children('.asset-download-btn').addClass('hidden');
                newli.children('.asset-linkurl-btn').addClass('hidden');
            }
        </mt:if>
        newli.children('span').html( col_value );
        <mt:if name="request.from_obj" ne="group">
        <mt:unless name="request.any_model">
        let innerButtons = newli.find('button');
        let btn_index = 0;
        let elementClass = innerButtons[btn_index].getAttribute( 'class' );
        if ( $('#edit-link-'+checked_ids[i]).length ) {
            if ( elementClass.indexOf('relation-editor') != -1 ) {
                elementClass = elementClass.replace('hidden', '');
                innerButtons[btn_index].setAttribute( 'class', elementClass );
                let elementHref = innerButtons[btn_index].getAttribute( 'data-href' );
                elementHref = elementHref.replace( '__value__', checked_ids[i] );
                innerButtons[btn_index].setAttribute( 'data-href', elementHref );
                innerButtons[btn_index].setAttribute( 'href', elementHref );
            }
        } else {
            // Has not Permission.
            if ( elementClass.indexOf('relation-editor') != -1 ) {
                innerButtons[btn_index].setAttribute( 'class', elementClass + ' hidden' );
            }
        }
        </mt:unless>
        </mt:if>
        newli.removeAttr('id');
        newli.addClass( target_control+'-child');
        <mt:if name="request.from_obj" ne="group">
        <mt:unless name="request.any_model">
        if ( newli.children('.assets-child-thumb').length ) {
            newli.children('.assets-child-thumb').attr('data-id',checked_ids[i]).css('background-image','url(\'<mt:var name="script_uri">?__mode=get_thumbnail&square=1&_model=<mt:var name="this_model" escape>&id=' + checked_ids[i] + '\')');
            newli.children('.assets-child-thumb').removeClass('hidden');
            newli.children('.assets-child-thumb').show();
        }
        </mt:unless>
        </mt:if>
        newli.show();
    }
    if(count){
        if(target_control && window.parent.setAssetThumbnail){
            window.parent.setAssetThumbnail(target_control,'<mt:var name="this_model">');
        }
    }
    if(target_control && window.parent.setRelatedObjectSelector){
        window.parent.setRelatedObjectSelector(target_control);
    }
</mt:if>
<mt:unless name="request.revision_select">
    window.location.href = '<mt:var name="script_uri">?__mode=loading';
    window.parent.$('#modal').modal('hide');
    window.parent.editContentChanged = true;
    return false;
</mt:unless>
});
</mt:if>
<mt:if name="_sortable">
<mt:unless name="request.dialog_view">
$('#list_body').sortable({
    stop: function( evt, ui ) {
        reorder();
    }
});
$('#list_body input').bind('click.sortable mousedown.sortable',function(ev){
    ev.target.focus();
});
function reorder(){
    <mt:if name="list_from">
    var i = <mt:var name="list_from">;
    <mt:else>
    var i = 1;
    </mt:if>
    <mt:property name="list_reorder_interval" setvar="list_reorder_interval">
    <mt:if name="list_order_desc">
    var tmp_raw = [];
    $('.order_col').each(function(){
        tmp_raw.push($(this));
    });
    tmp_raw.reverse();
    $.each(tmp_raw, function(index, item) {
        item.prop('value',i<mt:if name="list_reorder_interval">*<mt:var name="list_reorder_interval"><mt:elseif name="this_model" eq="table">*10</mt:if>);
        i++;
    });
    <mt:else>
    $('.order_col').each(function(){
        $(this).prop('value',i<mt:if name="list_reorder_interval">*<mt:var name="list_reorder_interval"><mt:elseif name="this_model" eq="table">*10</mt:if>);
        i++;
    });
    </mt:if>
}
</mt:unless>
</mt:if>
$('.query-box').change(function(){
    $('.query-box').val( $(this).val() );
});
$("input[name='id[]']").change(function(){
    set_all_select();
});
function set_all_select () {
    is_all = true;
    $("input[name='id[]']").each(function(){
        if ( $(this).prop('checked') == false ) {
            is_all = false;
            $('.cb-all-selected').prop('checked', false);
            $('.all-selected-cell').hide();
            return false;
        }
    });
    $('.selector').prop('checked', is_all );
}
$('.selector').click(function(){
    checked = $(this).prop('checked');
    $("input[name='id[]']").each(function(){
        $(this).prop('checked', checked);
    });
    $('.selector').prop('checked', checked);
<mt:if name="show_all_selected">
    if ( checked ) {
        $('.all-selected-cell').show();
    } else {
        $('.all-selected-cell').hide();
        $('.cb-all-selected').prop('checked', false);
    }
</mt:if>
<mt:if name="request.dialog_view">
  <mt:unless name="request.revision_select">
    <mt:unless name="_single_select">
    set_selected_cbs();
    </mt:unless>
  </mt:unless>
</mt:if>
});
$('.cb-all-selected').change(function(){
    $('.cb-all-selected').prop('checked', $(this).prop('checked'));
});
$('.__delete').click(function(){
    if ( in_search ) {
        return true;
    }
    if( item_checked( true ) == false ) {
        alert('<mt:trans phrase="You did not select any %s to delete." params="$label">');
        return false;
    }
    var selected_items = item_checked( true );
    var cfm_msg = '<mt:trans phrase="Are you sure you want to remove _1 %s?" params="$plural">';
    cfm_msg = cfm_msg.replace( '_1', selected_items );
    if(! confirm( cfm_msg ) ) {
        return false;
    }
    $("#__mode").prop('value', 'delete');
    $(this.form).submit();
    return true;
});
$('.__action').click(function(){
    if ( in_search ) {
        return;
    }
    if (! $('.select-action').val() ) {
        alert('<mt:trans phrase="You did not select any action.">');
        return false;
    }
    if ( need_action_input ) {
        action_input = $('#action-input-box').val();
        if (! action_input ) {
            alert('<mt:trans phrase="You did not any input.">');
            return false;
        }
    }
    if ( need_datetime_input ) {
        action_input = $('#action-datetime-box').val();
        if (! action_input ) {
            alert('<mt:trans phrase="You did not any input.">');
            return false;
        }
    }
    if( item_checked( true ) == false ){
        alert('<mt:trans phrase="You did not select any %s." params="$label">');
        return false;
    }
    var cfm_msg = '<mt:trans phrase="Are you sure you want to process _1 _2?">';
    var selected_items = item_checked( true );
    cfm_msg = cfm_msg.replace( '_1', selected_items );
    cfm_msg = cfm_msg.replace( '_2', '<mt:var name="plural">' );
    if(! confirm(cfm_msg) ) {
        return false;
    }
    if ( action_status_select ) {
        $('.itemset-action-input').val( $('.action-status-select').val() );
    }
    if ( need_datetime_input ) {
        $('.itemset-action-input').val( $('#action-input-box').val() );
    }
    $('#list-select-form').attr('target', '_self');
    var action_modal = $('[name=action_name] option:selected').attr('data-modal');
    if ( action_modal ) {
        $('#modal').modal();
        $('#list-select-form').attr('target', 'dialog-modal');
    }
    $("#__mode").prop('value', 'list_action');
    return true;
});
<mt:if name="_sortable">
$('.__save_order').click(function(){
    if ( in_search ) {
        return true;
    }
    if ( item_checked() == false ) {
        alert('<mt:trans phrase="You did not select any %s to save order." params="$label">');
        return false;
    }
    let message = '<mt:trans phrase="Are you sure you want to save order of selected %s?" params="$plural">';
    if ( $('.cb-all-selected').prop( 'checked' ) ) {
        message = message + ' <mt:trans phrase="Nothing applies to %s that are not visible." params="$plural">';
    }
    if(! confirm( message ) ) {
        return false;
    }
    $('#__mode').prop('value', 'save_order');
    return true;
});
</mt:if>
<mt:var name="setup_search">
var selected_item_count;
function item_checked( count ) {
    if ( count && $('.cb-all-selected').prop('checked') ) {
        return <mt:var name="editable_count">;
    }
    selected_item_count = 0;
    var selected = false;
    $("input[name='id[]']").each(function(){
        if($(this).prop('checked') === true) {
            selected = true;
            if (! count ) {
                return false;
            }
            selected_item_count++;
        }
    });
    if ( count ) {
        return selected_item_count;
    }
    return selected;
}
</script>
</mt:unless>

<script>
$(function() {
    $('img.lazy').lazyload();
    $('img.lazy').css('backgroundImage', 'url(<mt:var name="prototype_path">assets/img/layer-bg.png)');
    $('img.lazy').css('backgroundRepeat', 'repeat');
    $('img.lazy').css('backgroundSize', 'cover');
});
</script>

<mt:if name="hide_current_filter">
<script>
$('._current_filter').hide();
$('#filter-button').hide();
</script>
</mt:if>

<script>
<mt:unless name="request.revision_select">
<mt:unless name="request.workspace_select"><mt:unless name="request.workflow_model">
<mt:if name="can_revision">
<mt:if name="allow_revision_in_list">
$('.create_revision').click(function(){
    if ( !confirm('<mt:trans phrase="Are you sure you want to create revision of this %s?" params="$label">') ) {
        return false;
    }
});
</mt:if>
</mt:if>
<mt:if name="can_duplicate">
$('.clone_object').click(function(){
    if ( !confirm('<mt:trans phrase="Are you sure you want to duplicate this %s?" params="$label">') ) {
        return false;
    }
});
</mt:if></mt:unless></mt:unless>
</mt:unless>
$('.pull_back').click(function(){
    if ( !confirm('<mt:trans phrase="Are you sure you want to pull back this %s?" params="$label">') ) {
        return false;
    }
    window.location.href = $(this).attr('data-href');
});
var $win = $(window);
$win.on('load resize', function() {
    var windowWidth = window.innerWidth;
    if ( windowWidth > 768 ) {
        $('.info-box').html('');
        $('.info-box').hide();
        $('.toggle-icn').removeClass('fa-caret-up');
        $('.toggle-icn').addClass('fa-caret-down');
        $('.alt-search-button').hide();
        $('.list-col-primary').attr('colspan', 1);
    } else {
        $('.alt-search-button').show();
        $('.list-col-primary').attr('colspan', <mt:var name="list_colspan">);
    }
    $('.search-button').removeAttr('disabled');
    $('.alt-search-button').removeAttr('disabled');
    $('.query-box').removeAttr('disabled');
});
</script>

<mt:if name="request.dialog_view">
<mt:include file="include/dialog_footer.tmpl">
<mt:else>
<mt:include file="include/footer.tmpl">
</mt:if>